(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58476e56"],{"0b56":function(e,a,t){"use strict";t.r(a);var l=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("common-layout",[e._l(e.apps,(function(a,l){return t("div",{key:l,staticClass:"appsBox"},[t("div",{staticClass:"title"},[e._v(" "+e._s(a.show_name||a.name)+" ")]),t("div",{staticClass:"appsItems"},[t("a-row",e._l(a.apps,(function(a,l){return t("a-col",{key:l,staticClass:"appCardBox",attrs:{xs:24,sm:12,md:6,lg:6,xl:6}},[t("a-card",{staticClass:"appCard",attrs:{hoverable:""}},[t("template",{staticClass:"ant-card-actions",slot:"actions"},[t("a",{attrs:{href:"javascript:;"}},[e._v("操作")]),t("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.showAdd(a)}}},[e._v("创建")])]),t("a-card-meta",{attrs:{title:a.app_little_category,description:a.summary}},[t("a-avatar",{attrs:{slot:"avatar",src:a.icon},slot:"avatar"})],1)],2)],1)})),1)],1)])})),t("a-modal",{attrs:{width:1e3,title:"创建app"},on:{ok:e.handleOk},model:{value:e.visible,callback:function(a){e.visible=a},expression:"visible"}},[t("a-row",[t("a-col",{attrs:{xs:24,sm:12,md:12,lg:12,xl:12}},[t("a-form-model",{ref:"ruleForm",attrs:{model:e.modalForm,rules:e.rules,layout:e.formLayout}},[t("a-form-model-item",{ref:"show_name",attrs:{label:"名称","label-col":e.formItemLayout2.labelCol,"wrapper-col":e.formItemLayout2.wrapperCol,prop:"show_name"}},[t("a-input",{attrs:{placeholder:"名称"},model:{value:e.modalForm.show_name,callback:function(a){e.$set(e.modalForm,"show_name",a)},expression:"modalForm.show_name"}})],1),t("a-form-model-item",{ref:"tag",attrs:{label:"版本","label-col":e.formItemLayout2.labelCol,"wrapper-col":e.formItemLayout2.wrapperCol,prop:"tag"}},[t("a-select",{staticStyle:{width:"100%","padding-right":"30px"},attrs:{allowClear:"",placeholder:"请选择版本","show-search":"","default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":null},on:{search:e.handleSearch},model:{value:e.modalForm.tag,callback:function(a){e.$set(e.modalForm,"tag",a)},expression:"modalForm.tag"}},e._l(e.versions,(function(a,l){return t("a-select-option",{key:l,attrs:{value:a.version}},[e._v(" "+e._s(a.version)+" ")])})),1),t("a-button",{staticStyle:{position:"absolute",right:"0",top:"-7px"},attrs:{type:"link",icon:"search"},on:{click:e.showVersion}})],1),t("a-form-model-item",{ref:"mem",attrs:{label:"内存",prop:"mem","label-col":e.formItemLayout2.labelCol,"wrapper-col":e.formItemLayout2.wrapperCol}},[t("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",placeholder:"请选择内存"},model:{value:e.modalForm.mem,callback:function(a){e.$set(e.modalForm,"mem",a)},expression:"modalForm.mem"}},e._l(e.memList,(function(a,l){return t("a-select-option",{key:l,attrs:{value:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1)],1),t("a-form-model-item",{ref:"cpu",attrs:{label:"CPU",prop:"cpu","label-col":e.formItemLayout2.labelCol,"wrapper-col":e.formItemLayout2.wrapperCol}},[t("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",placeholder:"请选择CPU"},model:{value:e.modalForm.cpu,callback:function(a){e.$set(e.modalForm,"cpu",a)},expression:"modalForm.cpu"}},e._l(e.cpuList,(function(a,l){return t("a-select-option",{key:l,attrs:{value:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1)],1),e.is_need_volume?t("a-form-model-item",{ref:"volume_size",attrs:{label:"磁盘(G)","label-col":e.formItemLayout2.labelCol,"wrapper-col":e.formItemLayout2.wrapperCol,prop:"volume_size"}},[t("a-slider",{attrs:{marks:e.marks,min:20,max:2e3,step:10},model:{value:e.modalForm.volume_size,callback:function(a){e.$set(e.modalForm,"volume_size",a)},expression:"modalForm.volume_size"}})],1):e._e(),t("a-form-model-item",{ref:"sc",attrs:{label:"存储类型",prop:"sc","label-col":e.formItemLayout2.labelCol,"wrapper-col":e.formItemLayout2.wrapperCol}},[t("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",placeholder:"请选择存储类型"},model:{value:e.modalForm.sc,callback:function(a){e.$set(e.modalForm,"sc",a)},expression:"modalForm.sc"}},e._l(e.scList,(function(a,l){return t("a-select-option",{key:l,attrs:{value:a.name}},[e._v(" "+e._s(a.name)+e._s(a.allow_volume_expansion?"(可以扩容)":"(无法扩容)")+" ")])})),1)],1)],1)],1),t("a-col",{attrs:{xs:24,sm:12,md:12,lg:12,xl:12}},[t("div",{staticClass:"envs"},[t("div",{staticClass:"envTitle"},[e._v("环境变量")]),t("a-row",[t("a-col",{attrs:{span:1}}),t("a-col",{attrs:{span:10}},[e._v(" 键 ")]),t("a-col",{attrs:{span:10}},[e._v(" 值 ")]),t("a-col",{attrs:{span:3}})],1),t("a-form",{staticClass:"ant-advanced-search-form",attrs:{form:e.form}},e._l(e.env,(function(a,l){return t("a-row",{key:l},[t("a-col",{attrs:{span:1}}),t("a-col",{staticClass:"envInput",attrs:{span:10}},[t("a-form-item",[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["key"+l,{rules:[{required:!0,message:"必填"}]}],expression:"[`key${index}`, { rules: [{ required: true, message: '必填' }] }]"}],attrs:{placeholder:"键",disabled:a.disable}})],1)],1),t("a-col",{staticClass:"envInput",attrs:{span:10}},[t("a-form-item",[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["value"+l,{rules:[{required:!0,message:"必填"}]}],expression:"[`value${index}`, { rules: [{ required: true, message: '必填' }] }]"}],attrs:{placeholder:"值"}})],1)],1),t("a-col",{attrs:{span:3}},[a.disable?e._e():t("a-button",{staticClass:"subBtn",attrs:{size:"small",type:"link",icon:"delete"},on:{click:function(t){return e.subEnv(a,l)}}})],1)],1)})),1),t("a-button",{style:{width:"100px",marginLeft:"20px"},attrs:{size:"small",icon:"plus"},on:{click:e.addEnv}},[e._v("添加")])],1)])],1)],1),t("version-modal",{ref:"versionModal",attrs:{little_category:e.modalForm.app_little_category},on:{sureClick:e.sureClick}})],2)},o=[],r=t("5530"),s=t("ade3"),i=(t("d81d"),t("1276"),t("ac1f"),t("159b"),t("4de4"),t("d3b7"),t("25f0"),t("a434"),t("d808")),n=t("4ec3"),c=t("b775"),u=t("7424"),m=t("fd85"),d={name:"Apps",components:{CommonLayout:i["a"],VersionModal:n["a"]},data:function(){return{formLayout:"horizontal",marks:{20:"20",2e3:"2000"},apps:[],versions:[],cpuList:m["a"],memList:m["b"],scList:[],visible:!1,is_need_volume:!1,modalForm:{show_name:void 0,tag:void 0,cpu:void 0,mem:void 0,volume_size:20,app_little_category:void 0,sc:void 0},env:[],rules:{show_name:[{required:!0,message:"请输入名称",trigger:"blur"}],tag:[{required:!0,message:"请选择版本",trigger:"change"}],cpu:[{required:!0,message:"请选择CPU",trigger:"change"}],mem:[{required:!0,message:"请选择内存",trigger:"change"}],email:[{required:!0,message:"请输入邮箱号",trigger:"blur"}],role_id:[{required:!0,message:"请选择角色",trigger:"change"}],resource:[{required:!0,message:"请选择资源上限",trigger:"change"}]},form:this.$form.createForm(this,{name:"advanced_search"})}},computed:{formItemLayout2:function(){var e=this.formLayout;return"horizontal"===e?{labelCol:{span:6},wrapperCol:{span:18}}:{}}},mounted:function(){this.getApps(),this.getSC()},methods:{getApps:function(){var e=this;Object(c["d"])(u["GETTEMP"],c["a"].GET).then((function(a){e.apps=a.data.data}))},getSC:function(){var e=this;Object(c["d"])(u["GETSC"],c["a"].GET).then((function(a){e.scList=a.data.data}))},showAdd:function(e){this.env=[],this.getVersions({current:1,little_category:e.app_little_category,pageSize:50}),this.modalForm={show_name:void 0,tag:void 0,cpu:void 0,mem:void 0,volume_size:20,app_little_category:e.app_little_category},this.env=e.env?e.env.map((function(e){var a=e.split(":");return{key:a[0],value:a[1]||void 0,disable:!0}})):[],this.is_need_volume=e.is_need_volume,this.visible=!0;var a=this;this.form.resetFields(),setTimeout((function(){a.env.forEach((function(e,t){a.form.setFieldsValue(Object(s["a"])({},"key"+t,e.key),Object(s["a"])({},"value"+t,e.value))}))}),500)},close:function(){this.visible=!1},handleOk:function(e){var a=this;e.preventDefault(),this.$refs.ruleForm.validate((function(e){e&&a.form.validateFields((function(e,t){if(!e){var l=Object(r["a"])({},a.modalForm),o=a.env.map((function(e,a){return t["key"+a]?t["key"+a]+":"+t["value"+a]:void 0})).filter((function(e){return e}));l.env=o,l.volume_size=a.modalForm.volume_size.toString(),Object(c["d"])(u["ADDAPP"],c["a"].POST,l).then((function(){a.$message.success("创建成功"),a.close()}))}}))}))},addEnv:function(){this.env.push({key:null,value:null,disable:!1})},subEnv:function(e,a){this.env.splice(a,1)},handleSearch:function(e){this.getVersions({current:1,little_category:this.modalForm.app_little_category,pageSize:50,search:e})},getVersions:function(e){var a=this;Object(c["d"])(u["GETVERSION"],c["a"].POST,e).then((function(e){a.versions=e.data.data.tags||[]}))},showVersion:function(){this.$refs.versionModal.showVersion()},sureClick:function(e){this.getVersions({current:1,little_category:this.modalForm.app_little_category,pageSize:50,search:e}),this.modalForm.tag=e}}},v=d,p=(t("4f7f"),t("2877")),f=Object(p["a"])(v,l,o,!1,null,"f8377fba",null),h=f.exports;a["default"]=h},"12e0":function(e,a,t){},"1c66":function(e,a,t){},"4ec3":function(e,a,t){"use strict";var l=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-modal",{attrs:{width:1e3,dialogStyle:{top:"10px"},title:"选择版本"},on:{ok:e.sureClick},model:{value:e.verVisible,callback:function(a){e.verVisible=a},expression:"verVisible"}},[t("label",{attrs:{for:""}},[e._v("版本号:")]),t("a-input",{staticStyle:{width:"300px","margin-left":"10px"},attrs:{placeholder:"请输入版本号"},on:{change:e.changeVerS},model:{value:e.version,callback:function(a){e.version=a},expression:"version"}}),t("a-form",{staticClass:"ant-advanced-search2-form",attrs:{form:e.verform}},[t("a-list",{attrs:{"item-layout":"vertical",size:"small",pagination:e.pagination,"data-source":e.versionData},scopedSlots:e._u([{key:"renderItem",fn:function(a,l){return t("a-list-item",{key:"item.title",staticClass:"ver"},[t("a-checkable-tag",{on:{change:function(a){return e.selectVersion(l)}},model:{value:a.selected,callback:function(t){e.$set(a,"selected",t)},expression:"item.selected"}},[e._v(" "+e._s(a.version)+" ")])],1)}}])})],1)],1)},o=[],r=(t("d81d"),t("4de4"),t("b775")),s=t("7424"),i={data:function(){var e=this;return{verform:this.$form.createForm(this,{name:"advanced_search2"}),verVisible:!1,versionData:[],version:void 0,pagination:{type:[Object,Boolean],default:!0,total:0,showTotal:this.changeTotal,current:1,defaultCurrent:1,pageSize:50,defaultPageSize:50,size:"small",onChange:function(a){e.pagination.current=a,e.getTableData()}}}},props:{little_category:String},mounted:function(){},methods:{getTableData:function(){var e=this,a=this.pagination,t=a.current,l=a.pageSize;Object(r["d"])(s["GETVERSION"],r["a"].POST,{current:t,pageSize:l,search:this.version,little_category:this.little_category}).then((function(a){e.versionData=a.data.data.tags,e.pagination.total=a.data.data.count}))},showVersion:function(){this.verVisible=!0,this.getTableData()},closeVersion:function(){this.verVisible=!1},changeVerS:function(){this.getTableData()},selectVersion:function(e){this.versionData=this.versionData.map((function(a,t){return e==t&&a.selected||(a.selected=!1),a}))},sureClick:function(){var e=this.versionData.filter((function(e){return e.selected}))[0];e&&this.$emit("sureClick",e.version),this.closeVersion(),this.version=void 0}}},n=i,c=(t("800f"),t("2877")),u=Object(c["a"])(n,l,o,!1,null,"e3866cf0",null);a["a"]=u.exports},"4f7f":function(e,a,t){"use strict";t("1c66")},"800f":function(e,a,t){"use strict";t("ef23")},d808:function(e,a,t){"use strict";var l=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"common-layout"},[t("div",{staticClass:"content"},[e._t("default")],2)])},o=[],r={name:"CommonLayout"},s=r,i=(t("e168"),t("2877")),n=Object(i["a"])(s,l,o,!1,null,"6289d3e4",null);a["a"]=n.exports},e168:function(e,a,t){"use strict";t("12e0")},ef23:function(e,a,t){},fd85:function(e,a,t){"use strict";t.d(a,"a",(function(){return l})),t.d(a,"b",(function(){return o}));var l=[{value:"2",label:"2核"},{value:"4",label:"4核"},{value:"8",label:"8核"},{value:"16",label:"16核"},{value:"32",label:"32核"},{value:"64",label:"64核"},{value:"128",label:"128核"},{value:"256",label:"256核"},{value:"512",label:"512核"}],o=[{value:"2",label:"2G"},{value:"4",label:"4G"},{value:"8",label:"8G"},{value:"16",label:"16G"},{value:"32",label:"32G"},{value:"64",label:"64G"},{value:"128",label:"128G"},{value:"256",label:"256G"},{value:"512",label:"512G"},{value:"1024",label:"1024G"},{value:"2048",label:"2048G"},{value:"4096",label:"4096G"}]}}]);