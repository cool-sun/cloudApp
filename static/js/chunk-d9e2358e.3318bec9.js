(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d9e2358e"],{"0522":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"operate-container"},[e._t("default")],2)},o=[],r={name:"OperateContainer"},i=r,s=(a("4027"),a("2877")),l=Object(s["a"])(i,n,o,!1,null,"426291ca",null);t["a"]=l.exports},"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"12e0":function(e,t,a){},1641:function(e,t,a){"use strict";a("8cac")},"1a7c":function(e,t,a){"use strict";a("b2ac")},4027:function(e,t,a){"use strict";a("4224")},4224:function(e,t,a){},"4ec3":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{width:1e3,dialogStyle:{top:"10px"},title:"选择版本"},on:{ok:e.sureClick},model:{value:e.verVisible,callback:function(t){e.verVisible=t},expression:"verVisible"}},[a("label",{attrs:{for:""}},[e._v("版本号:")]),a("a-input",{staticStyle:{width:"300px","margin-left":"10px"},attrs:{placeholder:"请输入版本号"},on:{change:e.changeVerS},model:{value:e.version,callback:function(t){e.version=t},expression:"version"}}),a("a-form",{staticClass:"ant-advanced-search2-form",attrs:{form:e.verform}},[a("a-list",{attrs:{"item-layout":"vertical",size:"small",pagination:e.pagination,"data-source":e.versionData},scopedSlots:e._u([{key:"renderItem",fn:function(t,n){return a("a-list-item",{key:"item.title",staticClass:"ver"},[a("a-checkable-tag",{on:{change:function(t){return e.selectVersion(n)}},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"item.selected"}},[e._v(" "+e._s(t.version)+" ")])],1)}}])})],1)],1)},o=[],r=(a("d81d"),a("4de4"),a("b775")),i=a("7424"),s={data:function(){var e=this;return{verform:this.$form.createForm(this,{name:"advanced_search2"}),verVisible:!1,versionData:[],version:void 0,pagination:{type:[Object,Boolean],default:!0,total:0,showTotal:this.changeTotal,current:1,defaultCurrent:1,pageSize:50,defaultPageSize:50,size:"small",onChange:function(t){e.pagination.current=t,e.getTableData()}}}},props:{little_category:String},mounted:function(){},methods:{getTableData:function(){var e=this,t=this.pagination,a=t.current,n=t.pageSize;Object(r["d"])(i["GETVERSION"],r["a"].POST,{current:a,pageSize:n,search:this.version,little_category:this.little_category}).then((function(t){e.versionData=t.data.data.tags,e.pagination.total=t.data.data.count}))},showVersion:function(){this.verVisible=!0,this.getTableData()},closeVersion:function(){this.verVisible=!1},changeVerS:function(){this.getTableData()},selectVersion:function(e){this.versionData=this.versionData.map((function(t,a){return e==a&&t.selected||(t.selected=!1),t}))},sureClick:function(){var e=this.versionData.filter((function(e){return e.selected}))[0];e&&this.$emit("sureClick",e.version),this.closeVersion(),this.version=void 0}}},l=s,c=(a("800f"),a("2877")),u=Object(c["a"])(l,n,o,!1,null,"e3866cf0",null);t["a"]=u.exports},"800f":function(e,t,a){"use strict";a("ef23")},"841c":function(e,t,a){"use strict";var n=a("d784"),o=a("825a"),r=a("1d80"),i=a("129f"),s=a("14c3");n("search",1,(function(e,t,a){return[function(t){var a=r(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,a):new RegExp(t)[e](String(a))},function(e){var n=a(t,e,this);if(n.done)return n.value;var r=o(e),l=String(this),c=r.lastIndex;i(c,0)||(r.lastIndex=0);var u=s(r,l);return i(r.lastIndex,c)||(r.lastIndex=c),null===u?-1:u.index}]}))},8443:function(e,t,a){"use strict";a("d895")},8732:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"search-container"},[e._t("default")],2)},o=[],r={name:"SearchContainer"},i=r,s=(a("8443"),a("2877")),l=Object(s["a"])(i,n,o,!1,null,"321645a4",null);t["a"]=l.exports},"8cac":function(e,t,a){},a005:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("common-layout",[a("search-container",[a("a-form",{attrs:{layout:e.formLayout,form:e.form},on:{submit:e.handleSubmit}},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{xs:24,sm:24,md:24,lg:8,xl:8}},[a("a-form-item",{attrs:{label:"名称",colon:!0,"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[a("a-input",{attrs:{placeholder:"名称"},model:{value:e.show_name,callback:function(t){e.show_name=t},expression:"show_name"}})],1)],1),a("a-col",{attrs:{xs:24,sm:24,md:24,lg:8,xl:8}},[a("a-form-item",{attrs:{label:"类别",colon:!0,"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[a("a-cascader",{attrs:{placeholder:"请选择应用类别",options:e.options,"change-on-select":""},on:{change:e.changeType},model:{value:e.category,callback:function(t){e.category=t},expression:"category"}})],1)],1),a("a-col",{attrs:{xs:24,sm:24,md:24,lg:8,xl:8}},[a("a-form-item",[a("a-button-group",[a("a-button",{attrs:{type:"primary","html-type":"submit"}},[e._v(" 查询 ")]),a("a-button",{on:{click:e.reset}},[e._v(" 重置 ")])],1)],1)],1)],1),1==e.roles?a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{xs:24,sm:24,md:24,lg:8,xl:8}},[a("a-form-item",{attrs:{label:"用户",colon:!0,"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[a("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",placeholder:"请选择用户"},model:{value:e.user,callback:function(t){e.user=t},expression:"user"}},e._l(e.users,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.name}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1)],1):e._e()],1)],1),a("operate-container",[a("a-button",{attrs:{type:"primary"},on:{click:e.addApp}},[e._v(" 创建 ")])],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.data,pagination:e.pagination},on:{change:e.onChange},scopedSlots:e._u([{key:"name",fn:function(t){return a("a",{},[e._v(e._s(t))])}},{key:"end_point",fn:function(t,n){return[a("div"),e._v(" 集群内："+e._s(n.end_point.in)+" "),a("div"),e._v(" 集群外："+e._s(n.end_point.out||"未开启")+" ")]}},{key:"action",fn:function(t,n){return a("span",{},[a("a",{on:{click:function(a){return e.restart(t,n)}}},[e._v("重启")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-dropdown",{attrs:{trigger:["click"]}},[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v(" 更多"),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},on:{click:function(a){return e.operate(a,t,n)}},slot:"overlay"},[a("a-sub-menu",{key:"快照",attrs:{title:"快照"}},[a("a-menu-item",{key:"创建存储快照"},[e._v(" 创建存储快照 ")]),a("a-menu-item",{key:"从快照恢复"},[e._v(" 从快照恢复 ")])],1),a("a-sub-menu",{key:"扩缩容",attrs:{title:"扩缩容"}},[a("a-menu-item",{key:"内存CPU调整"},[e._v(" 内存CPU调整 ")]),a("a-menu-item",{key:"磁盘扩容"},[e._v(" 磁盘扩容 ")])],1),a("a-menu-item",{key:"副本数伸缩"},[e._v(" 副本数伸缩 ")]),a("a-menu-item",{key:"停止"},[e._v(" 停止 ")]),a("a-menu-item",{key:"删除"},[e._v(" 删除 ")]),a("a-menu-item",{key:"更换版本"},[e._v(" 更换版本 ")]),a("a-sub-menu",{key:"网络设置",attrs:{title:"网络设置"}},[a("a-menu-item",{key:"开启集群外访问"},[e._v(" 开启集群外访问 ")]),a("a-menu-item",{key:"关闭集群外访问"},[e._v(" 关闭集群外访问 ")])],1),a("a-menu-item",{key:"修改环境变量"},[e._v(" 修改环境变量 ")])],1)],1)],1)}}])}),a("a-modal",{attrs:{title:"调整内存和CPU"},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("a-form-model",{ref:"ruleForm",attrs:{model:e.modalForm,rules:e.rules,layout:e.formLayout}},[a("a-form-model-item",{ref:"mem",attrs:{label:"内存",prop:"mem","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[a("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",placeholder:"请选择内存"},model:{value:e.modalForm.mem,callback:function(t){e.$set(e.modalForm,"mem",t)},expression:"modalForm.mem"}},e._l(e.memList,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1),a("a-form-model-item",{ref:"cpu",attrs:{label:"CPU",prop:"cpu","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[a("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",placeholder:"请选择CPU"},model:{value:e.modalForm.cpu,callback:function(t){e.$set(e.modalForm,"cpu",t)},expression:"modalForm.cpu"}},e._l(e.cpuList,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1)],1),a("a-modal",{attrs:{title:"更新副本数"},on:{ok:e.handleUpdateOk},model:{value:e.updateVisible,callback:function(t){e.updateVisible=t},expression:"updateVisible"}},[a("a-form-model",{ref:"ruleUpdateForm",attrs:{model:e.updateForm,rules:e.rules,layout:e.formLayout}},[a("a-form-model-item",{ref:"replicas",attrs:{label:"",prop:"replicas","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[a("a-input",{attrs:{placeholder:"请输入副本数"},model:{value:e.updateForm.replicas,callback:function(t){e.$set(e.updateForm,"replicas",t)},expression:"updateForm.replicas"}})],1)],1)],1),a("a-modal",{attrs:{title:"创建存储快照"},on:{ok:e.handleCreateSnapshotOk},model:{value:e.snapshotVisible,callback:function(t){e.snapshotVisible=t},expression:"snapshotVisible"}},[a("a-form-model",{ref:"ruleSnapshotForm",attrs:{model:e.createSnapshotForm,rules:e.rules,layout:e.formLayout}},[a("a-form-model-item",{ref:"show_name",attrs:{label:"快照名称",prop:"show_name","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[a("a-input",{attrs:{placeholder:"请输入快照名称"},model:{value:e.createSnapshotForm.show_name,callback:function(t){e.$set(e.createSnapshotForm,"show_name",t)},expression:"createSnapshotForm.show_name"}})],1)],1)],1),a("a-modal",{attrs:{width:600,title:"更新环境变量"},on:{ok:e.handleENVOk},model:{value:e.envVisible,callback:function(t){e.envVisible=t},expression:"envVisible"}},[a("div",{staticClass:"envs"},[a("div",{staticClass:"envTitle"},[e._v("环境变量")]),a("a-row",[a("a-col",{attrs:{span:1}}),a("a-col",{attrs:{span:10}},[e._v(" 键 ")]),a("a-col",{attrs:{span:10}},[e._v(" 值 ")]),a("a-col",{attrs:{span:3}})],1),a("a-form",{staticClass:"ant-advanced-search-form",attrs:{form:e.form}},e._l(e.env,(function(t,n){return a("a-row",{key:n},[a("a-col",{attrs:{span:1}}),a("a-col",{staticClass:"envInput",attrs:{span:10}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["key"+n,{rules:[{required:!0,message:"必填"}]}],expression:"[`key${index}`, { rules: [{ required: true, message: '必填' }] }]"}],attrs:{placeholder:"键"}})],1)],1),a("a-col",{staticClass:"envInput",attrs:{span:10}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["value"+n,{rules:[{required:!0,message:"必填"}]}],expression:"[`value${index}`, { rules: [{ required: true, message: '必填' }] }]"}],attrs:{placeholder:"值"}})],1)],1),a("a-col",{attrs:{span:3}},[t.disable?e._e():a("a-button",{staticClass:"subBtn",attrs:{size:"small",type:"link",icon:"delete"},on:{click:function(a){return e.subEnv(t,n)}}})],1)],1)})),1),a("a-button",{style:{width:"100px",marginLeft:"20px"},attrs:{size:"small",icon:"plus"},on:{click:e.addEnv}},[e._v("添加")])],1)]),a("a-modal",{attrs:{title:"更换版本"},on:{ok:e.handleVersionOk},model:{value:e.versionVisible,callback:function(t){e.versionVisible=t},expression:"versionVisible"}},[a("a-form-model",{ref:"ruleVersionForm",attrs:{model:e.versionForm,rules:e.rules,layout:e.formLayout}},[a("a-form-model-item",{ref:"version",attrs:{label:"请选择版本",prop:"version","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[a("a-select",{staticStyle:{width:"100%","padding-right":"30px"},attrs:{allowClear:"",placeholder:"请选择版本","show-search":"","default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":null},on:{search:e.handleSearch},model:{value:e.versionForm.version,callback:function(t){e.$set(e.versionForm,"version",t)},expression:"versionForm.version"}},e._l(e.versions,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.version}},[e._v(" "+e._s(t.version)+" ")])})),1),a("a-button",{staticStyle:{position:"absolute",right:"0",top:"-7px"},attrs:{type:"link",icon:"search"},on:{click:e.showVersion}})],1)],1)],1),a("a-modal",{attrs:{width:800,title:"从快照恢复"},on:{ok:e.handleRenewOk},model:{value:e.renewVisible,callback:function(t){e.renewVisible=t},expression:"renewVisible"}},[e.renewVisible?a("snapshot-modal",{attrs:{appInfo:e.renewData.record},on:{selectData:e.getSelectData}}):e._e()],1),a("version-modal",{ref:"versionModal",attrs:{little_category:e.versionForm.app_little_category},on:{sureClick:e.sureClick}})],1)},o=[],r=a("ade3"),i=a("5530"),s=(a("99af"),a("d81d"),a("b0c0"),a("1276"),a("ac1f"),a("159b"),a("4de4"),a("a434"),a("5880")),l=a("d808"),c=a("8732"),u=a("0522"),m=a("4ec3"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("common-layout",[a("search-container",[a("a-form",{attrs:{layout:e.formLayout,form:e.form},on:{submit:e.handleSubmit}},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{xs:24,sm:24,md:24,lg:8,xl:8}},[a("a-form-item",{attrs:{label:"快照名称",colon:!0,"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[a("a-input",{attrs:{placeholder:"快照名称"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1),a("a-col",{attrs:{xs:24,sm:24,md:24,lg:8,xl:8}},[a("a-form-item",[a("a-button-group",[a("a-button",{attrs:{type:"primary","html-type":"submit"}},[e._v(" 查询 ")]),a("a-button",{on:{click:e.reset}},[e._v(" 重置 ")])],1)],1)],1)],1)],1)],1),a("a-table",{attrs:{"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.rowSelection,type:"radio"},columns:e.columns,"data-source":e.data,pagination:e.pagination},on:{change:e.onChange}})],1)},p=[],f=(a("841c"),a("b775")),h=a("7424"),v=a("c1df"),b=a.n(v),g={name:"Snapshot",components:{CommonLayout:l["a"],SearchContainer:c["a"]},props:{appInfo:{}},data:function(){return{formLayout:"horizontal",users:[],form:this.$form.createForm(this,{name:"horizontal_login"}),search:void 0,data:[],columns:[{title:"快照名称",dataIndex:"show_name",key:"show_name",width:120},{title:"创建时间",dataIndex:"create_time",key:"create_time",ellipsis:!0,width:170,customRender:function(e){return b()(e).format("YYYY-MM-DD HH:mm:ss")}}],pagination:{type:[Object,Boolean],default:!0,total:0,showTotal:this.changeTotal,current:1,defaultCurrent:1,pageSize:10,defaultPageSize:10,pageSizeOptions:["10","50","100","500"],showSizeChanger:!0,showQuickJumper:!0,size:"small"},selectedRows:[],selectedRowKeys:[]}},computed:{formItemLayout:function(){var e=this.formLayout;return"horizontal"===e?{labelCol:{span:6},wrapperCol:{span:18}}:{}}},mounted:function(){var e=this;this.$nextTick((function(){e.getTableData()}))},methods:{rowSelection:function(e,t){this.selectedRows=t,this.selectedRowKeys=e,this.$emit("selectData",t)},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e){e||(t.pagination={type:[Object,Boolean],default:!0,total:0,showTotal:t.changeTotal,current:1,defaultCurrent:1,pageSize:10,defaultPageSize:10,pageSizeOptions:["10","50","100","500"],showSizeChanger:!0,showQuickJumper:!0,size:"small"},t.getTableData())}))},reset:function(){this.search=void 0},onChange:function(e,t,a,n){n.currentDataSource;this.pagination.current=e.current,this.pagination.pageSize=e.pageSize,this.getTableData()},changeTotal:function(e){return"总共 "+e+" 条数据"},getTableData:function(){var e=this,t=this.pagination,a=t.current,n=t.pageSize;Object(f["d"])(h["GETSNAPSHOT"],f["a"].POST,{current:a,pageSize:n,app_name:this.appInfo.name,search:this.search}).then((function(t){e.data=t.data.data.list,e.selectedRows=[],e.selectedRowKeys=[],e.pagination.total=t.data.data.count}))}}},y=g,_=(a("1641"),a("2877")),w=Object(_["a"])(y,d,p,!1,null,"bbdfe8c4",null),k=w.exports,S=a("fd85"),C={name:"MyApp",components:{CommonLayout:l["a"],SearchContainer:c["a"],VersionModal:m["a"],SnapshotModal:k,OperateContainer:u["a"]},data:function(){var e=this.$createElement;return{form:this.$form.createForm(this,{name:"horizontal_login"}),formLayout:"horizontal",options:[],users:[],category:[],show_name:void 0,user:void 0,data:[],columns:1==this.roles?[{title:"名字",dataIndex:"name",key:"name",customRender:function(e,t){return t.show_name?t.show_name:e}},{title:"用户名",dataIndex:"name",key:"name"},{title:"访问地址",dataIndex:"end_point",key:"end_point",scopedSlots:{customRender:"end_point"}},{title:"状态",dataIndex:"status",key:"status",width:120,customRender:function(t){return t?1==t?e("div",[e("a-icon",{attrs:{type:"stop"},class:"red"})," 停止"]):2==t||3==t?e("div",[e("a-icon",{attrs:{type:"play-circle"},class:"green"})," ready"]):null:e("div",[e("a-icon",{attrs:{type:"loading"},class:"grey"})," 创建中"])}},{title:"所属类别",dataIndex:"app_big_category_show_name",key:"app_big_category_show_name",customRender:function(e,t){return"".concat(e," > ").concat(t.app_little_category_show_name)}},{title:"创建时间",dataIndex:"create_time",key:"create_time",ellipsis:!0,width:220,customRender:function(e){return b()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"操作",dataIndex:"",key:"x",width:160,scopedSlots:{customRender:"action"}}]:[{title:"名称",dataIndex:"name",key:"name",customRender:function(e,t){return t.show_name?t.show_name:e}},{title:"访问地址",dataIndex:"end_point",key:"end_point",scopedSlots:{customRender:"end_point"}},{title:"状态",dataIndex:"status",key:"status",width:120,customRender:function(t){return t?1==t?e("div",[e("a-icon",{attrs:{type:"stop"},class:"red"})," 停止"]):2==t||3==t?e("div",[e("a-icon",{attrs:{type:"play-circle"},class:"green"})," 正常运行"]):null:e("div",[e("a-icon",{attrs:{type:"loading"},class:"grey"})," 创建中"])}},{title:"类别",dataIndex:"app_big_category_show_name",key:"app_big_category_show_name",customRender:function(e,t){return"".concat(e," > ").concat(t.app_little_category_show_name)}},{title:"创建时间",dataIndex:"create_time",key:"create_time",ellipsis:!0,width:220,customRender:function(e){return b()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"操作",dataIndex:"",key:"x",width:160,scopedSlots:{customRender:"action"}}],pagination:{type:[Object,Boolean],default:!0,total:0,showTotal:this.changeTotal,current:1,defaultCurrent:1,pageSize:10,defaultPageSize:10,pageSizeOptions:["10","50","100","500"],showSizeChanger:!0,showQuickJumper:!0,size:"small"},visible:!1,cpuList:S["a"],memList:S["b"],modalForm:{cpu:void 0,mem:void 0,name:void 0},rules:{cpu:[{required:!0,message:"请选择CPU",trigger:"change"}],mem:[{required:!0,message:"请选择内存",trigger:"change"}],replicas:[{required:!0,message:"请输入副本数",trigger:"blur"}],version:[{required:!0,message:"请选择版本",trigger:"change"}],show_name:[{required:!0,message:"请输入快照名称",trigger:"blur"}]},updateVisible:!1,updateForm:{replicas:void 0,name:void 0},envVisible:!1,envName:void 0,env:[],versionVisible:!1,versionForm:{version:void 0,app_little_category:void 0},versions:[],createSnapshotForm:{app_name:void 0,show_name:void 0},snapshotVisible:!1,renewVisible:!1,renewData:{selectData:null,record:null}}},computed:Object(i["a"])(Object(i["a"])({},Object(s["mapGetters"])("account",["roles"])),{},{formItemLayout:function(){var e=this.formLayout;return"horizontal"===e?{labelCol:{span:6},wrapperCol:{span:18}}:{}}}),mounted:function(){var e=this;this.$nextTick((function(){e.getTableData(),e.getAppType(),1==e.roles&&e.getUser()}))},methods:{getAppType:function(){var e=this;Object(f["d"])(h["GETTEMP"],f["a"].GET).then((function(t){e.options=t.data.data.map((function(e){return{value:e.name,label:e.show_name,children:e.apps&&e.apps.length?e.apps.map((function(e){return{value:e.app_little_category,label:e.show_name}})):void 0}}))}))},getUser:function(){var e=this;Object(f["d"])(h["GETUSER"],f["a"].POST,{current:1,pageSize:1e3}).then((function(t){e.users=t.data.data.list}))},changeType:function(e){this.category=e},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e){e||(t.pagination={type:[Object,Boolean],default:!0,total:0,showTotal:t.changeTotal,current:1,defaultCurrent:1,pageSize:10,defaultPageSize:10,pageSizeOptions:["10","50","100","500"],showSizeChanger:!0,showQuickJumper:!0,size:"small"},t.getTableData())}))},reset:function(){this.user=void 0,this.category=[],this.show_name=void 0},onChange:function(e,t,a,n){n.currentDataSource;this.pagination.current=e.current,this.pagination.pageSize=e.pageSize,this.getTableData()},changeTotal:function(e){return"总共 "+e+" 条数据"},getTableData:function(){var e=this,t=this.pagination,a=t.current,n=t.pageSize;Object(f["d"])(h["GETAPP"],f["a"].POST,{current:a,pageSize:n,category:this.category[this.category.length-1],show_name:this.show_name,user_name:this.user}).then((function(t){e.data=t.data.data.list,e.selectedRows=[],e.selectedRowKeys=[],e.pagination.total=t.data.data.count}))},handleOk:function(e){var t=this;e.preventDefault(),this.$refs.ruleForm.validate((function(e){if(!e)return!1;Object(f["d"])(h["SCALEAPP"],f["a"].POST,t.modalForm).then((function(){t.closeScale(),t.$message.success("操作成功"),t.getTableData()}))}))},closeScale:function(){this.visible=!1},closeUpdate:function(){this.updateVisible=!1},handleUpdateOk:function(e){var t=this;e.preventDefault(),this.$refs.ruleSnapshotForm.validate((function(e){if(!e)return!1;Object(f["d"])(h["REPLICAS"],f["a"].POST,t.updateForm).then((function(){t.closeUpdate(),t.$message.success("操作成功"),t.getTableData()}))}))},addApp:function(){this.$router.push("/app/os")},operate:function(e,t){if("内存CPU调整"!==e.key)if("副本数伸缩"!==e.key)if("停止"!==e.key)if("删除"!==e.key)if("修改环境变量"!==e.key)if("更换版本"!==e.key)if("开启集群外访问"!==e.key){if("关闭集群外访问"!==e.key)return"创建存储快照"===e.key?(this.snapshotVisible=!0,this.createSnapshotForm.app_name=t.name,void(this.createSnapshotForm.show_name=void 0)):void("从快照恢复"===e.key&&(this.renewVisible=!0,this.renewData={selectData:null,record:t}));this.confirmOperate("确定关闭该APP集群外访问入口?",h["OPENAPP"],t)}else this.confirmOperate("确定开启该APP集群外访问入口?",h["OPENAPP"],t);else this.showVerModal(t);else{var a=this;this.getDetail(t.name,(function(e){a.form.resetFields(),a.envVisible=!0,a.envName=t.name,a.env=e.main_container.env?e.main_container.env.map((function(e){var t=e.split(":");return{key:t[0],value:t[1]||void 0}})):[],setTimeout((function(){a.env.forEach((function(e,t){var n;a.form.setFieldsValue((n={},Object(r["a"])(n,"key"+t,e.key),Object(r["a"])(n,"value"+t,e.value),n))}))}),500)}),(function(){}))}else this.confirmOperate("确定删除该APP?",h["DELETEAPP"],t);else this.confirmOperate("确定停止该APP?",h["STOPAPP"],t);else{this.updateVisible=!0;var n=this;this.getDetail(t.name,(function(e){n.updateForm={name:t.name,replicas:e.replicas}}),(function(){n.modalForm.name=t.name}))}else{this.visible=!0;var o=this;this.getDetail(t.name,(function(e){o.modalForm={name:t.name,cpu:e.main_container.cpu,mem:e.main_container.mem}}),(function(){o.modalForm.name=t.name}))}},restart:function(e){this.confirmOperate("确定重启该APP?",h["RESTARTAPP"],e)},confirmOperate:function(e,t,a){var n=this;this.$confirm({title:e,onOk:function(){var o={name:a.name};"确定开启该APP集群外访问入口?"===e&&(o.is_open=!0),"确定关闭该APP集群外访问入口?"===e&&(o.is_open=!1),Object(f["d"])(t,f["a"].POST,o).then((function(){n.$message.success("操作成功"),n.getTableData()}))}})},getDetail:function(e,t,a){Object(f["d"])(h["APPDETAIL"]+e,f["a"].GET).then((function(e){t(e.data.data)})).catch((function(){a()}))},handleENVOk:function(){var e=this;this.form.validateFields((function(t,a){if(!t){var n=e.env.map((function(e,t){return a["key"+t]?a["key"+t]+":"+a["value"+t]:void 0})).filter((function(e){return e}));Object(f["d"])(h["ENV"],f["a"].POST,{name:e.envName,env:n}).then((function(){e.$message.success("操作成功！"),e.envVisible=!1}))}}))},addEnv:function(){this.env.push({key:null,value:null})},subEnv:function(e,t){this.env.splice(t,1)},showVerModal:function(e){var t=this;this.versionVisible=!0,this.getDetail(e.name,(function(a){t.versionForm={name:e.name,version:a.main_container.tag,app_little_category:a.app_little_category}}),(function(){t.versionForm.name=e.name}))},handleSearch:function(e){this.getVersions({current:1,little_category:this.versionForm.app_little_category,pageSize:50,search:e})},getVersions:function(e){var t=this;Object(f["d"])(h["GETVERSION"],f["a"].POST,e).then((function(e){t.versions=e.data.data.tags||[]}))},showVersion:function(){this.$refs.versionModal.showVersion()},sureClick:function(e){this.getVersions({current:1,little_category:this.versionForm.app_little_category,pageSize:50,search:e}),this.versionForm.version=e},handleVersionOk:function(e){var t=this;e.preventDefault(),this.$refs.ruleVersionForm.validate((function(e){if(e){var a=t;Object(f["d"])(h["CHANGEVERSION"],f["a"].POST,t.versionForm).then((function(){a.versionVisible=!1,a.$message.success("操作成功"),a.getTableData()}))}}))},handleCreateSnapshotOk:function(e){var t=this;e.preventDefault(),this.$refs.ruleSnapshotForm.validate((function(e){if(e){var a=t;Object(f["d"])(h["CREATESNAPSHOT"],f["a"].POST,t.createSnapshotForm).then((function(){a.snapshotVisible=!1,a.$message.success("操作成功")}))}}))},getSelectData:function(e){this.renewData.selectData=e},handleRenewOk:function(){var e=this;this.renewData.selectData?Object(f["d"])(h["RESTORE"],f["a"].POST,{snapshot_id:this.renewData.selectData[0].id,app_name:this.renewData.record.name}).then((function(){e.renewVisible=!1,e.$message.success("恢复成功，请稍后重启app生效")})):e.$message.warning("请先选择需要恢复的快照")}}},O=C,x=(a("1a7c"),Object(_["a"])(O,n,o,!1,null,"28c222b5",null)),T=x.exports;t["default"]=T},b2ac:function(e,t,a){},d808:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common-layout"},[a("div",{staticClass:"content"},[e._t("default")],2)])},o=[],r={name:"CommonLayout"},i=r,s=(a("e168"),a("2877")),l=Object(s["a"])(i,n,o,!1,null,"6289d3e4",null);t["a"]=l.exports},d895:function(e,t,a){},e168:function(e,t,a){"use strict";a("12e0")},ef23:function(e,t,a){},fd85:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return o}));var n=[{value:"2",label:"2核"},{value:"4",label:"4核"},{value:"8",label:"8核"},{value:"16",label:"16核"},{value:"32",label:"32核"},{value:"64",label:"64核"},{value:"128",label:"128核"},{value:"256",label:"256核"},{value:"512",label:"512核"}],o=[{value:"2",label:"2G"},{value:"4",label:"4G"},{value:"8",label:"8G"},{value:"16",label:"16G"},{value:"32",label:"32G"},{value:"64",label:"64G"},{value:"128",label:"128G"},{value:"256",label:"256G"},{value:"512",label:"512G"},{value:"1024",label:"1024G"},{value:"2048",label:"2048G"},{value:"4096",label:"4096G"}]}}]);