(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7737086a"],{"0522":function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"operate-container"},[e._t("default")],2)},o=[],r={name:"OperateContainer"},n=r,i=(a("4027"),a("2877")),s=Object(i["a"])(n,l,o,!1,null,"426291ca",null);t["a"]=s.exports},"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"12e0":function(e,t,a){},4027:function(e,t,a){"use strict";a("4224")},4224:function(e,t,a){},"5d58":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("common-layout",[a("search-container",[a("a-form",{attrs:{layout:e.formLayout,form:e.form},on:{submit:e.handleSubmit}},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{xs:24,sm:24,md:24,lg:8,xl:8}},[a("a-form-item",{attrs:{label:"角色",colon:!0,"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[a("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",placeholder:"请选择角色"},model:{value:e.role_id,callback:function(t){e.role_id=t},expression:"role_id"}},[a("a-select-option",{attrs:{value:1}},[e._v(" 管理员 ")]),a("a-select-option",{attrs:{value:2}},[e._v(" 开发者 ")])],1)],1)],1),a("a-col",{attrs:{xs:24,sm:24,md:24,lg:8,xl:8}},[a("a-form-item",{attrs:{label:"用户名称/手机号/邮箱",colon:!0,"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[a("a-input",{attrs:{placeholder:"用户名称/手机号/邮箱"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-item",[a("a-button-group",[a("a-button",{attrs:{type:"primary","html-type":"submit"}},[e._v(" 查询 ")]),a("a-button",{on:{click:e.reset}},[e._v(" 重置 ")])],1)],1)],1)],1)],1)],1),a("operate-container",[a("a-button-group",[a("a-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v(" 添加 ")]),a("a-button",{on:{click:e.batchDelete}},[e._v(" 批量删除 ")])],1)],1),a("a-table",{attrs:{"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.rowSelection},columns:e.columns,"data-source":e.data,pagination:e.pagination},on:{change:e.onChange},scopedSlots:e._u([{key:"name",fn:function(t){return a("a",{},[e._v(e._s(t))])}},{key:"action",fn:function(t){return a("a",{attrs:{href:"javascript:;"},on:{click:function(a){return e.edit(t)}}},[e._v("修改")])}}])}),a("a-modal",{attrs:{title:e.title},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("a-form-model",{ref:"ruleForm",attrs:{model:e.modalForm,rules:e.rules,layout:e.formLayout}},[a("a-form-model-item",{ref:"name",attrs:{label:"用户名","label-col":e.formItemLayout2.labelCol,"wrapper-col":e.formItemLayout2.wrapperCol,prop:"name"}},[a("a-input",{attrs:{disabled:"修改用户"==e.title,placeholder:"用户名"},model:{value:e.modalForm.name,callback:function(t){e.$set(e.modalForm,"name",t)},expression:"modalForm.name"}})],1),"添加用户"==e.title?a("a-form-model-item",{ref:"password",attrs:{label:"密码","label-col":e.formItemLayout2.labelCol,"wrapper-col":e.formItemLayout2.wrapperCol,prop:"password"}},[a("a-input",{attrs:{disabled:"修改用户"==e.title,placeholder:"密码"},model:{value:e.modalForm.password,callback:function(t){e.$set(e.modalForm,"password",t)},expression:"modalForm.password"}})],1):e._e(),a("a-form-model-item",{ref:"email",attrs:{label:"邮箱号","label-col":e.formItemLayout2.labelCol,"wrapper-col":e.formItemLayout2.wrapperCol,prop:"email"}},[a("a-input",{attrs:{placeholder:"邮箱号"},model:{value:e.modalForm.email,callback:function(t){e.$set(e.modalForm,"email",t)},expression:"modalForm.email"}})],1),a("a-form-model-item",{ref:"phone",attrs:{label:"手机号","label-col":e.formItemLayout2.labelCol,"wrapper-col":e.formItemLayout2.wrapperCol,prop:"phone"}},[a("a-input",{attrs:{placeholder:"手机号"},model:{value:e.modalForm.phone,callback:function(t){e.$set(e.modalForm,"phone",t)},expression:"modalForm.phone"}})],1),a("a-form-model-item",{ref:"role_id",attrs:{label:"角色","label-col":e.formItemLayout2.labelCol,"wrapper-col":e.formItemLayout2.wrapperCol,prop:"role_id"}},[a("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:""},model:{value:e.modalForm.role_id,callback:function(t){e.$set(e.modalForm,"role_id",t)},expression:"modalForm.role_id"}},[a("a-select-option",{attrs:{value:1}},[e._v(" 管理员 ")]),a("a-select-option",{attrs:{value:2}},[e._v(" 开发者 ")])],1)],1),a("a-form-model-item",{ref:"resource",attrs:{label:"资源上限","label-col":e.formItemLayout2.labelCol,"wrapper-col":e.formItemLayout2.wrapperCol,prop:"resource"}},[a("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",placeholder:"请选择资源上限"},model:{value:e.modalForm.resource,callback:function(t){e.$set(e.modalForm,"resource",t)},expression:"modalForm.resource"}},[a("a-select-option",{attrs:{value:0}},[e._v(" 不限制 ")]),a("a-select-option",{attrs:{value:1}},[e._v(" 限制 ")])],1)],1),e.modalForm.resource?a("a-form-model-item",{ref:"cpu",attrs:{label:"CPU",prop:"cpu","label-col":e.formItemLayout2.labelCol,"wrapper-col":e.formItemLayout2.wrapperCol}},[a("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",placeholder:"请选择CPU"},model:{value:e.modalForm.cpu,callback:function(t){e.$set(e.modalForm,"cpu",t)},expression:"modalForm.cpu"}},e._l(e.cpuList,(function(t,l){return a("a-select-option",{key:l,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1):e._e(),e.modalForm.resource?a("a-form-model-item",{ref:"mem",attrs:{label:"内存",prop:"mem","label-col":e.formItemLayout2.labelCol,"wrapper-col":e.formItemLayout2.wrapperCol}},[a("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",placeholder:"请选择内存"},model:{value:e.modalForm.mem,callback:function(t){e.$set(e.modalForm,"mem",t)},expression:"modalForm.mem"}},e._l(e.memList,(function(t,l){return a("a-select-option",{key:l,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1):e._e()],1)],1),a("a-modal",{attrs:{title:"批量删除"},on:{ok:e.handleDeleteOk},model:{value:e.deleteVisible,callback:function(t){e.deleteVisible=t},expression:"deleteVisible"}},[a("a-list",{staticClass:"demo-loadmore-list",attrs:{"item-layout":"horizontal","data-source":e.selectedRows},scopedSlots:e._u([{key:"renderItem",fn:function(t){return a("a-list-item",{},[a("a",{attrs:{slot:"actions"},slot:"actions"},[a("a-checkbox",{model:{value:t.delete,callback:function(a){e.$set(t,"delete",a)},expression:"item.delete"}}),e._v(" 删除名下所有APP ")],1),a("div",[e._v(e._s(t.name))])])}}])})],1)],1)},o=[],r=a("5530"),n=(a("b64b"),a("841c"),a("ac1f"),a("b0c0"),a("d81d"),a("d808")),i=a("8732"),s=a("0522"),c=a("b775"),u=a("7424"),m=a("c1df"),d=a.n(m),p=a("fd85");function f(e){return Object.keys(e).some((function(t){return e[t]}))}var b={name:"User",components:{CommonLayout:n["a"],SearchContainer:i["a"],OperateContainer:s["a"]},data:function(){var e=this.$createElement;return{hasErrors:f,form:this.$form.createForm(this,{name:"horizontal_login"}),formLayout:"horizontal",data:[],columns:[{title:"名字",dataIndex:"name",key:"name",width:100},{title:"邮箱号",dataIndex:"email",key:"email"},{title:"手机号",dataIndex:"phone",key:"phone",width:140},{title:"角色",dataIndex:"role_id",key:"role_id",customRender:function(e){return 1===e?"管理员":2===e?"开发者":""},width:80},{title:"资源",dataIndex:"resource_quota",key:"resource_quota",customRender:function(t){return t?e("div",[e("div",["cpu：".concat(t.cpu,"G")]),e("div",["内存：".concat(t.mem,"G")])]):"不限制"},width:120},{title:"创建时间",dataIndex:"create_time",key:"create_time",ellipsis:!0,customRender:function(e){return d()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"修改时间",dataIndex:"modify_time",key:"modify_time",ellipsis:!0,customRender:function(e){return d()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"操作",dataIndex:"",key:"x",width:60,scopedSlots:{customRender:"action"}}],role_id:void 0,search:void 0,pagination:{type:[Object,Boolean],default:!0,total:0,showTotal:this.changeTotal,current:1,defaultCurrent:1,pageSize:10,defaultPageSize:10,pageSizeOptions:["10","50","100","500"],showSizeChanger:!0,showQuickJumper:!0,size:"small"},title:"添加用户",visible:!1,cpuList:p["a"],memList:p["b"],modalForm:{name:null,password:"123456",phone:null,email:null,role_id:2,resource:0,cpu:void 0,mem:void 0},rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱号",trigger:"blur"}],role_id:[{required:!0,message:"请选择角色",trigger:"change"}],resource:[{required:!0,message:"请选择资源上限",trigger:"change"}],cpu:[{required:!0,message:"请选择CPU",trigger:"change"}],mem:[{required:!0,message:"请选择内存",trigger:"change"}]},selectedRows:[],selectedRowKeys:[],deleteVisible:!1}},computed:{formItemLayout:function(){var e=this.formLayout;return"horizontal"===e?{labelCol:{span:10},wrapperCol:{span:14}}:{}},formItemLayout2:function(){var e=this.formLayout;return"horizontal"===e?{labelCol:{span:6},wrapperCol:{span:18}}:{}}},mounted:function(){var e=this;this.$nextTick((function(){e.getTableData()}))},methods:{rowSelection:function(e,t){this.selectedRows=t,this.selectedRowKeys=e},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e){e||(t.pagination={type:[Object,Boolean],default:!0,total:0,showTotal:t.changeTotal,current:1,defaultCurrent:1,pageSize:10,defaultPageSize:10,pageSizeOptions:["10","50","100","500"],showSizeChanger:!0,showQuickJumper:!0,size:"small"},t.getTableData())}))},reset:function(){this.role_id=void 0,this.search=void 0},onChange:function(e,t,a,l){l.currentDataSource;this.pagination.current=e.current,this.pagination.pageSize=e.pageSize,this.getTableData()},changeTotal:function(e){return"总共 "+e+" 条数据"},getTableData:function(){var e=this,t=this.pagination,a=t.current,l=t.pageSize;Object(c["d"])(u["GETUSER"],c["a"].POST,{current:a,pageSize:l,role_id:this.role_id,search:this.search}).then((function(t){e.data=t.data.data.list,e.selectedRows=[],e.selectedRowKeys=[],e.pagination.total=t.data.data.count}))},handleOk:function(e){var t=this;e.preventDefault(),this.$refs.ruleForm.validate((function(e){if(!e)return!1;var a=Object(r["a"])({},t.modalForm);a.resource&&(a.resource_quota={},a.resource_quota.cpu=a.cpu,a.resource_quota.mem=a.mem),delete a.resource;var l="添加用户"===t.title?u["ADDUSER"]:u["EDITUSER"];Object(c["d"])(l,c["a"].POST,a).then((function(){t.$message.success("操作成功"),t.getTableData(),t.close()}))}))},add:function(){this.visible=!0,this.title="添加用户",this.modalForm={name:null,password:"123456",phone:null,email:null,role_id:2,resource:0,cpu:void 0,mem:void 0}},edit:function(e){this.visible=!0,this.title="修改用户",this.modalForm={name:e.name,password:e.password,phone:e.phone,email:e.email,role_id:e.role_id,resource:e.resource_quota?1:0,cpu:e.resource_quota?e.resource_quota.cpu:null,mem:e.resource_quota?e.resource_quota.mem:null}},close:function(){this.visible=!1},batchDelete:function(){this.deleteVisible=!0},closeDelete:function(){this.deleteVisible=!1},handleDeleteOk:function(){var e=this,t=this.selectedRows.map((function(e){return{is_clean_app:!!e.delete,name:e.name}}));Object(c["d"])(u["DELETEUSER"],c["a"].POST,{users:t}).then((function(){e.$message.success("操作成功"),e.getTableData(),e.closeDelete()}))}}},h=b,v=a("2877"),w=Object(v["a"])(h,l,o,!1,null,"017af188",null),_=w.exports;t["default"]=_},"841c":function(e,t,a){"use strict";var l=a("d784"),o=a("825a"),r=a("1d80"),n=a("129f"),i=a("14c3");l("search",1,(function(e,t,a){return[function(t){var a=r(this),l=void 0==t?void 0:t[e];return void 0!==l?l.call(t,a):new RegExp(t)[e](String(a))},function(e){var l=a(t,e,this);if(l.done)return l.value;var r=o(e),s=String(this),c=r.lastIndex;n(c,0)||(r.lastIndex=0);var u=i(r,s);return n(r.lastIndex,c)||(r.lastIndex=c),null===u?-1:u.index}]}))},8443:function(e,t,a){"use strict";a("d895")},8732:function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"search-container"},[e._t("default")],2)},o=[],r={name:"SearchContainer"},n=r,i=(a("8443"),a("2877")),s=Object(i["a"])(n,l,o,!1,null,"321645a4",null);t["a"]=s.exports},d808:function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common-layout"},[a("div",{staticClass:"content"},[e._t("default")],2)])},o=[],r={name:"CommonLayout"},n=r,i=(a("e168"),a("2877")),s=Object(i["a"])(n,l,o,!1,null,"6289d3e4",null);t["a"]=s.exports},d895:function(e,t,a){},e168:function(e,t,a){"use strict";a("12e0")},fd85:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return o}));var l=[{value:"2",label:"2核"},{value:"4",label:"4核"},{value:"8",label:"8核"},{value:"16",label:"16核"},{value:"32",label:"32核"},{value:"64",label:"64核"},{value:"128",label:"128核"},{value:"256",label:"256核"},{value:"512",label:"512核"}],o=[{value:"2",label:"2G"},{value:"4",label:"4G"},{value:"8",label:"8G"},{value:"16",label:"16G"},{value:"32",label:"32G"},{value:"64",label:"64G"},{value:"128",label:"128G"},{value:"256",label:"256G"},{value:"512",label:"512G"},{value:"1024",label:"1024G"},{value:"2048",label:"2048G"},{value:"4096",label:"4096G"}]}}]);